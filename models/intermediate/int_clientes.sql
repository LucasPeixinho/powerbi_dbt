SELECT 
    CODCLI, 
    CLIENTE,
    
    -- Tratamento da DTPRIMCOMPRA
    CASE 
        WHEN DTPRIMCOMPRA IS NULL THEN TO_DATE('01/01/1900', 'DD/MM/YYYY')
        WHEN DTPRIMCOMPRA < TO_DATE('01/01/1900', 'DD/MM/YYYY') THEN TO_DATE('01/01/1900', 'DD/MM/YYYY')
        WHEN DTPRIMCOMPRA > SYSDATE THEN TO_DATE('01/01/1900', 'DD/MM/YYYY')
        ELSE DTPRIMCOMPRA
    END AS DTPRIMCOMPRA_TRATADA,
    
    -- Tratamento da INICIOATIV
    CASE 
        WHEN INICIOATIV IS NULL THEN TO_DATE('01/01/1900', 'DD/MM/YYYY')
        WHEN INICIOATIV < TO_DATE('01/01/1900', 'DD/MM/YYYY') THEN TO_DATE('01/01/1900', 'DD/MM/YYYY')
        WHEN INICIOATIV > SYSDATE THEN TO_DATE('01/01/1900', 'DD/MM/YYYY')
        ELSE INICIOATIV
    END AS INICIOATIV_TRATADA,
    
    BAIRROCOM,
    
    CASE 
        WHEN TIPOFJ = 'F' THEN 'Física' 
        ELSE 'Jurídica' 
    END AS TIPO_CLIENTE
    
FROM {{ ref('stg_clientes')}}